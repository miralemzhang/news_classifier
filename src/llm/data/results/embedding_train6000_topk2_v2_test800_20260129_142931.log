======================================================================
 两阶段分类器 - 训练与评估
 Stage 1: Embedding (Top-2) + Stage 2: Reranker (Top-1)
======================================================================
数据文件: /home/zzh/webpage-classification/data/labeled/labeled.jsonl
训练样本: 6000 条
测试样本: 800 条
Top-K: 2
Doc版本: v2 (简洁字符串)
保存路径: models/matrix_train6000.pt
======================================================================

[1/5] 加载数据...
  总计: 6888 条
  训练集: 6000 条
  测试集: 800 条

[2/5] 初始化分类器...
============================================================
 两阶段分类器初始化
============================================================

[Stage 1] 加载 Embedding 模型...
正在加载模型: /home/zzh/webpage-classification/models/Qwen3-VL-Embedding-8B
设备: cuda, 数据类型: torch.bfloat16
正在计算类别模板嵌入...
已初始化 8 个类别的嵌入
模型加载完成!

[Stage 2] 加载 Reranker 模型...
  使用默认注意力机制
  Reranker 加载完成: /home/zzh/webpage-classification/models/Qwen3-VL-Reranker-8B

============================================================
 初始化完成
============================================================

[3/5] 训练 Embedding...

============================================================
 从标注数据训练类别嵌入
============================================================
训练数据分布:
  时政: 2135 条
  经济: 848 条
  军事: 308 条
  社会: 1433 条
  科技: 293 条
  体育: 324 条
  娱乐: 296 条
  其他: 363 条
  总计: 6000 条

计算类别嵌入...
  时政: 使用 2135 个样本
